/**
 * HTML 5 media compatibility layer.
 * 
 * Allows the use of video tags within all browsers to play videos encoded in
 * the MPEG-4 and h.264 formats.
 * 
 * Developed by Dave Hall <david@etianen.com>
 * 
 * <http://www.etianen.com/>
 */


(function(d){function m(a,e,c,f,b,i,j){c&&d("img",a).length==0&&a.append(d("<img>",{src:c,width:a.width(),height:a.height()}));var g=null;if(f)g={fullscreen:false,autoHide:"always",hideDelay:1E3};a.flowplayer(o,{onBeforeUnload:function(){return false},play:null,playlist:[{url:c},{url:e,autoPlay:b,autoBuffering:i,onBeforeFinish:function(){return j}}],plugins:{controls:g}}).flowplayer(0).load()}function h(a,e){a=a.attr(e);return a==true||typeof a=="string"}var n=document.createElement("video"),k=Boolean(n.canPlayType&&
n.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),l="";d("script").each(function(){var a=d(this).attr("src");if(a.substr(-20)=="jquery.html5media.js"||a.substr(-24)=="jquery.html5media.min.js")l=a.split("/").slice(0,-1).join("/")+"/"});var o=l+"flowplayer.swf";if(!k&&!d.fn.flowplayer){document.write('<script src="'+l+'flowplayer.js"><\/script>');d(function(){d("video").each(function(){var a=d(this),e=a.attr("src"),c=a.attr("poster"),f=h(a,"controls"),b=h(a,"autoplay"),i=h(a,"autobuffer"),
j=h(a,"loop");if(!k){var g=d("<div/>",{width:a.attr("width"),height:a.attr("height"),"class":a.attr("class"),id:a.attr("id"),title:a.attr("title")});a.replaceWith(g);m(g,e,c,f,b,i,j)}})})}d.fn.video=function(a){this.each(function(){var e=d(this),c=e.attr("class"),f=e.attr("id"),b={src:e.attr("href"),poster:d("img",e).attr("src"),controls:false,autoplay:false,autobuffer:false,loop:false,width:e.width(),height:e.height()};a&&d.extend(b,a);if(k){c=d("<video/>").attr("id",f).attr("class",c).attr("src",
b.src).attr("poster",b.poster).attr("width",b.width).attr("height",b.height);b.controls&&c.attr("controls","controls");b.autoplay&&c.attr("autoplay","autoplay");b.autobuffer&&c.attr("autobuffer","autobuffer");b.loop&&c.attr("loop","loop");e.replaceWith(c)}else{c=d("<div/>").attr("id",f).attr("class",c).width(b.width).height(b.height);e.replaceWith(c);m(c,b.src,b.poster,b.controls,b.autoplay,b.autobuffer,b.loop)}})}})(jQuery);